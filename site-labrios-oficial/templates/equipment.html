{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Equipamentos</h2>
    <a href="/" class="btn btn-secondary btn-pill btn-sm">Voltar</a>
</div>

<table class="table table-hover align-middle shadow-sm bg-white rounded">
    <thead class="table-dark">
        <tr><th>Foto</th><th>Nome</th><th>Marca/Modelo</th><th>Finalidade</th><th>Qtd</th><th>Ação</th></tr>
    </thead>
    <tbody>
        {% for e in equipments %}
        <tr>
            <td>
                {% if e.image %}
                <img src="{{ e.image }}" width="80" class="rounded shadow-sm" style="cursor: zoom-in;" onclick="ampliar('{{ e.image }}')">
                {% else %}Sem foto{% endif %}
            </td>
            <td><strong>{{ e.name }}</strong></td>
            <td>{{ e.brand }} / {{ e.model }}</td>
            <td><small>{{ e.purpose }}</small></td>
            <td>{{ e.quantity }}</td>
            <td>
                <a href="/reserve/{{ e.id }}" class="btn btn-primary btn-pill btn-sm">Solicitar</a>
                {% if current_user.is_authenticated %}
                <form action="/admin/delete_equipment/{{ e.id }}" method="POST" class="d-inline ms-1">
                    <button class="btn btn-danger btn-pill btn-sm">x</button>
                </form>
                {% endif %}
            </td>
        </tr>
        {% else %}<tr><td colspan="6" class="text-center">Nenhum equipamento cadastrado.</td></tr>{% endfor %}
    </tbody>
</table>

<!-- Overlay para ampliação -->
<div id="overlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:10000; text-align:center;" onclick="this.style.display='none'">
    <img id="imgZoom" style="max-height:90%; max-width:90%; margin-top:5vh; border: 5px solid white;">
</div>

<script>
function ampliar(url) {
    document.getElementById('imgZoom').src = url;
    document.getElementById('overlay').style.display = 'block';
}
</script>
{% endblock %}
